#!/usr/bin/env bash
# SENTINEL - Docker Security Module
# Version: 1.0.0
# Description: Provides helper functions for Docker security operations.
# Dependencies: logging

# --- Module Metadata ---
SENTINEL_MODULE_NAME="docker_security"
SENTINEL_MODULE_DESCRIPTION="Docker security helper functions"
SENTINEL_MODULE_VERSION="1.0.0"
SENTINEL_MODULE_DEPENDENCIES="logging"

# --- Core Functions ---

# Scan a Docker image for vulnerabilities using trivy.
# Usage: scan_image <image_name>
scan_image() {
    local image_name="$1"

    if [[ -z "$image_name" ]]; then
        sentinel_log_error "docker_security" "Image name is required."
        return 1
    fi

    if ! command -v trivy &> /dev/null; then
        sentinel_log_error "docker_security" "trivy is not installed. Please install it to use this feature."
        return 1
    fi

    sentinel_log_info "docker_security" "Scanning image: $image_name"

    trivy image "$image_name"
}

# --- Exports ---
export -f scan_image
